2018-10-25 21:05:01,030 - INFO - allennlp.common.from_params - instantiating class <class 'allennlp.data.dataset_readers.dataset_reader.DatasetReader'> from params {'type': 'unaligned_corpora'} and extras {}
2018-10-25 21:05:01,035 - INFO - allennlp.common.params - dataset_reader.type = unaligned_corpora
2018-10-25 21:05:01,035 - INFO - allennlp.common.from_params - instantiating class <class 'mt_gan.dataset_readers.unaligned_corpora_dataset_reader.UnilignedCorporaDatasetReader'> from params {} and extras {}
2018-10-25 21:05:01,036 - INFO - allennlp.common.params - dataset_reader.token_indexers_A = <allennlp.common.params.Params object at 0x7f0d036acda0>
2018-10-25 21:05:01,036 - INFO - allennlp.common.params - dataset_reader.token_indexers_B = <allennlp.common.params.Params object at 0x7f0d036acda0>
2018-10-25 21:05:01,037 - INFO - allennlp.common.params - dataset_reader.lazy = False
2018-10-25 21:05:01,037 - INFO - allennlp.common.params - validation_dataset_reader = None
2018-10-25 21:05:01,037 - INFO - allennlp.common.params - train_data_path = toy_data/train.txt
2018-10-25 21:05:01,037 - INFO - allennlp.commands.train - Reading training data from toy_data/train.txt
2018-10-25 21:05:01,038 - INFO - mt_gan.dataset_readers.unaligned_corpora_dataset_reader - Reading instances from lines in file at: toy_data/train.txt
2018-10-25 21:05:09,217 - INFO - allennlp.common.params - validation_data_path = toy_data/dev.txt
2018-10-25 21:05:09,218 - INFO - allennlp.commands.train - Reading validation data from toy_data/dev.txt
2018-10-25 21:05:09,218 - INFO - mt_gan.dataset_readers.unaligned_corpora_dataset_reader - Reading instances from lines in file at: toy_data/dev.txt
2018-10-25 21:05:09,278 - INFO - allennlp.common.params - test_data_path = None
2018-10-25 21:05:09,278 - INFO - allennlp.commands.train - From dataset instances, train, validation will be considered for vocabulary creation.
2018-10-25 21:05:09,278 - INFO - allennlp.common.params - vocabulary.type = None
2018-10-25 21:05:09,278 - INFO - allennlp.common.params - vocabulary.extend = False
2018-10-25 21:05:09,279 - INFO - allennlp.common.params - vocabulary.directory_path = None
2018-10-25 21:05:09,279 - INFO - allennlp.common.params - vocabulary.min_count = None
2018-10-25 21:05:09,279 - INFO - allennlp.common.params - vocabulary.max_vocab_size = None
2018-10-25 21:05:09,279 - INFO - allennlp.common.params - vocabulary.non_padded_namespaces = ('*tags', '*labels')
2018-10-25 21:05:09,279 - INFO - allennlp.common.params - vocabulary.min_pretrained_embeddings = None
2018-10-25 21:05:09,279 - INFO - allennlp.common.params - vocabulary.only_include_pretrained_words = False
2018-10-25 21:05:09,279 - INFO - allennlp.common.params - vocabulary.tokens_to_add = None
2018-10-25 21:05:09,279 - INFO - allennlp.data.vocabulary - Fitting token dictionary from dataset.
2018-10-25 21:05:11,223 - INFO - allennlp.common.from_params - instantiating class <class 'allennlp.models.model.Model'> from params {'discriminators': {'embedding_dim': 30, 'encoder': {'bidirectional': True, 'hidden_size': 30, 'input_size': 30, 'num_layers': 1, 'type': 'lstm'}, 'type': 'seq2prob'}, 'generators': {'attention': {'type': 'dot_product'}, 'beam_size': 5, 'embedding_dim': 30, 'encoder': {'bidirectional': True, 'hidden_size': 30, 'input_size': 30, 'num_layers': 1, 'type': 'lstm'}, 'max_decoding_steps': 15, 'type': 'rnn2rnn'}, 'type': 'mt_gan'} and extras {'vocab': <allennlp.data.vocabulary.Vocabulary object at 0x7f0cde16bfd0>}
2018-10-25 21:05:11,224 - INFO - allennlp.common.params - model.type = mt_gan
2018-10-25 21:05:11,224 - INFO - allennlp.common.params - model.vocab_namespace_A = vocab_A
2018-10-25 21:05:11,224 - INFO - allennlp.common.params - model.vocab_namespace_B = vocab_B
2018-10-25 21:05:11,224 - INFO - allennlp.common.params - model.generators.type = rnn2rnn
2018-10-25 21:05:11,225 - INFO - allennlp.common.params - model.generators.embedding_dim = 30
2018-10-25 21:05:11,225 - INFO - allennlp.common.from_params - instantiating class <class 'allennlp.modules.seq2seq_encoders.seq2seq_encoder.Seq2SeqEncoder'> from params {'bidirectional': True, 'hidden_size': 30, 'input_size': 30, 'num_layers': 1, 'type': 'lstm'} and extras {}
2018-10-25 21:05:11,225 - INFO - allennlp.common.params - type = lstm
2018-10-25 21:05:11,226 - INFO - allennlp.common.params - batch_first = True
2018-10-25 21:05:11,226 - INFO - allennlp.common.params - stateful = False
2018-10-25 21:05:11,226 - INFO - allennlp.common.params - Converting Params object to dict; logging of default values will not occur when dictionary parameters are used subsequently.
2018-10-25 21:05:11,226 - INFO - allennlp.common.params - CURRENTLY DEFINED PARAMETERS: 
2018-10-25 21:05:11,226 - INFO - allennlp.common.params - bidirectional = True
2018-10-25 21:05:11,226 - INFO - allennlp.common.params - hidden_size = 30
2018-10-25 21:05:11,227 - INFO - allennlp.common.params - input_size = 30
2018-10-25 21:05:11,227 - INFO - allennlp.common.params - num_layers = 1
2018-10-25 21:05:11,227 - INFO - allennlp.common.params - batch_first = True
2018-10-25 21:05:11,228 - INFO - allennlp.common.from_params - instantiating class <class 'allennlp.modules.seq2seq_encoders.seq2seq_encoder.Seq2SeqEncoder'> from params {'bidirectional': True, 'hidden_size': 30, 'input_size': 30, 'num_layers': 1, 'type': 'lstm'} and extras {}
2018-10-25 21:05:11,228 - INFO - allennlp.common.params - type = lstm
2018-10-25 21:05:11,228 - INFO - allennlp.common.params - batch_first = True
2018-10-25 21:05:11,228 - INFO - allennlp.common.params - stateful = False
2018-10-25 21:05:11,228 - INFO - allennlp.common.params - Converting Params object to dict; logging of default values will not occur when dictionary parameters are used subsequently.
2018-10-25 21:05:11,228 - INFO - allennlp.common.params - CURRENTLY DEFINED PARAMETERS: 
2018-10-25 21:05:11,229 - INFO - allennlp.common.params - bidirectional = True
2018-10-25 21:05:11,229 - INFO - allennlp.common.params - hidden_size = 30
2018-10-25 21:05:11,229 - INFO - allennlp.common.params - input_size = 30
2018-10-25 21:05:11,229 - INFO - allennlp.common.params - num_layers = 1
2018-10-25 21:05:11,229 - INFO - allennlp.common.params - batch_first = True
2018-10-25 21:05:11,230 - INFO - allennlp.common.from_params - instantiating class <class 'allennlp.modules.attention.attention.Attention'> from params {'type': 'dot_product'} and extras {}
2018-10-25 21:05:11,230 - INFO - allennlp.common.params - type = dot_product
2018-10-25 21:05:11,230 - INFO - allennlp.common.from_params - instantiating class <class 'allennlp.modules.attention.dot_product_attention.DotProductAttention'> from params {} and extras {}
2018-10-25 21:05:11,231 - INFO - allennlp.common.params - normalize = True
2018-10-25 21:05:11,231 - INFO - allennlp.common.from_params - instantiating class <class 'allennlp.modules.attention.attention.Attention'> from params {'type': 'dot_product'} and extras {}
2018-10-25 21:05:11,231 - INFO - allennlp.common.params - type = dot_product
2018-10-25 21:05:11,231 - INFO - allennlp.common.from_params - instantiating class <class 'allennlp.modules.attention.dot_product_attention.DotProductAttention'> from params {} and extras {}
2018-10-25 21:05:11,231 - INFO - allennlp.common.params - normalize = True
2018-10-25 21:05:11,232 - INFO - allennlp.common.params - model.generators.max_decoding_steps = 15
2018-10-25 21:05:11,233 - INFO - allennlp.common.params - model.discriminators.type = seq2prob
2018-10-25 21:05:11,233 - INFO - allennlp.common.from_params - instantiating class <class 'allennlp.modules.seq2vec_encoders.seq2vec_encoder.Seq2VecEncoder'> from params {'bidirectional': True, 'hidden_size': 30, 'input_size': 30, 'num_layers': 1, 'type': 'lstm'} and extras {}
2018-10-25 21:05:11,233 - INFO - allennlp.common.params - type = lstm
2018-10-25 21:05:11,233 - INFO - allennlp.common.params - batch_first = True
2018-10-25 21:05:11,233 - INFO - allennlp.common.params - Converting Params object to dict; logging of default values will not occur when dictionary parameters are used subsequently.
2018-10-25 21:05:11,233 - INFO - allennlp.common.params - CURRENTLY DEFINED PARAMETERS: 
2018-10-25 21:05:11,233 - INFO - allennlp.common.params - bidirectional = True
2018-10-25 21:05:11,234 - INFO - allennlp.common.params - hidden_size = 30
2018-10-25 21:05:11,234 - INFO - allennlp.common.params - input_size = 30
2018-10-25 21:05:11,234 - INFO - allennlp.common.params - num_layers = 1
2018-10-25 21:05:11,234 - INFO - allennlp.common.params - batch_first = True
2018-10-25 21:05:11,234 - INFO - allennlp.common.from_params - instantiating class <class 'allennlp.modules.seq2vec_encoders.seq2vec_encoder.Seq2VecEncoder'> from params {'bidirectional': True, 'hidden_size': 30, 'input_size': 30, 'num_layers': 1, 'type': 'lstm'} and extras {}
2018-10-25 21:05:11,235 - INFO - allennlp.common.params - type = lstm
2018-10-25 21:05:11,235 - INFO - allennlp.common.params - batch_first = True
2018-10-25 21:05:11,235 - INFO - allennlp.common.params - Converting Params object to dict; logging of default values will not occur when dictionary parameters are used subsequently.
2018-10-25 21:05:11,235 - INFO - allennlp.common.params - CURRENTLY DEFINED PARAMETERS: 
2018-10-25 21:05:11,235 - INFO - allennlp.common.params - bidirectional = True
2018-10-25 21:05:11,235 - INFO - allennlp.common.params - hidden_size = 30
2018-10-25 21:05:11,235 - INFO - allennlp.common.params - input_size = 30
2018-10-25 21:05:11,235 - INFO - allennlp.common.params - num_layers = 1
2018-10-25 21:05:11,236 - INFO - allennlp.common.params - batch_first = True
2018-10-25 21:05:11,236 - INFO - allennlp.common.params - model.discriminators.embedding_dim = 30
2018-10-25 21:05:11,238 - INFO - allennlp.common.from_params - instantiating class <class 'allennlp.data.iterators.data_iterator.DataIterator'> from params {'batch_size': 3, 'type': 'basic'} and extras {}
2018-10-25 21:05:11,238 - INFO - allennlp.common.params - iterator.type = basic
2018-10-25 21:05:11,238 - INFO - allennlp.common.from_params - instantiating class <class 'allennlp.data.iterators.basic_iterator.BasicIterator'> from params {'batch_size': 3} and extras {}
2018-10-25 21:05:11,238 - INFO - allennlp.common.params - iterator.batch_size = 3
2018-10-25 21:05:11,239 - INFO - allennlp.common.params - iterator.instances_per_epoch = None
2018-10-25 21:05:11,239 - INFO - allennlp.common.params - iterator.max_instances_in_memory = None
2018-10-25 21:05:11,239 - INFO - allennlp.common.params - iterator.cache_instances = False
2018-10-25 21:05:11,239 - INFO - allennlp.common.params - iterator.track_epoch = False
2018-10-25 21:05:11,239 - INFO - allennlp.common.params - iterator.maximum_samples_per_batch = None
2018-10-25 21:05:11,239 - INFO - allennlp.common.params - validation_iterator = None
2018-10-25 21:05:11,239 - INFO - allennlp.common.params - trainer.no_grad = ()
2018-10-25 21:05:11,240 - INFO - allennlp.commands.train - Following parameters are Frozen  (without gradient):
2018-10-25 21:05:11,240 - INFO - allennlp.commands.train - Following parameters are Tunable (with gradient):
2018-10-25 21:05:11,240 - INFO - allennlp.commands.train - _generator_A_to_B._source_embedding.weight
2018-10-25 21:05:11,240 - INFO - allennlp.commands.train - _generator_A_to_B._encoder._module.weight_ih_l0
2018-10-25 21:05:11,240 - INFO - allennlp.commands.train - _generator_A_to_B._encoder._module.weight_hh_l0
2018-10-25 21:05:11,240 - INFO - allennlp.commands.train - _generator_A_to_B._encoder._module.bias_ih_l0
2018-10-25 21:05:11,240 - INFO - allennlp.commands.train - _generator_A_to_B._encoder._module.bias_hh_l0
2018-10-25 21:05:11,240 - INFO - allennlp.commands.train - _generator_A_to_B._encoder._module.weight_ih_l0_reverse
2018-10-25 21:05:11,241 - INFO - allennlp.commands.train - _generator_A_to_B._encoder._module.weight_hh_l0_reverse
2018-10-25 21:05:11,241 - INFO - allennlp.commands.train - _generator_A_to_B._encoder._module.bias_ih_l0_reverse
2018-10-25 21:05:11,241 - INFO - allennlp.commands.train - _generator_A_to_B._encoder._module.bias_hh_l0_reverse
2018-10-25 21:05:11,241 - INFO - allennlp.commands.train - _generator_A_to_B._target_embedding.weight
2018-10-25 21:05:11,241 - INFO - allennlp.commands.train - _generator_A_to_B._decoder_cell.weight_ih
2018-10-25 21:05:11,241 - INFO - allennlp.commands.train - _generator_A_to_B._decoder_cell.weight_hh
2018-10-25 21:05:11,241 - INFO - allennlp.commands.train - _generator_A_to_B._decoder_cell.bias_ih
2018-10-25 21:05:11,241 - INFO - allennlp.commands.train - _generator_A_to_B._decoder_cell.bias_hh
2018-10-25 21:05:11,241 - INFO - allennlp.commands.train - _generator_A_to_B._output_projection_layer.weight
2018-10-25 21:05:11,242 - INFO - allennlp.commands.train - _generator_A_to_B._output_projection_layer.bias
2018-10-25 21:05:11,242 - INFO - allennlp.commands.train - _generator_B_to_A._encoder._module.weight_ih_l0
2018-10-25 21:05:11,242 - INFO - allennlp.commands.train - _generator_B_to_A._encoder._module.weight_hh_l0
2018-10-25 21:05:11,242 - INFO - allennlp.commands.train - _generator_B_to_A._encoder._module.bias_ih_l0
2018-10-25 21:05:11,242 - INFO - allennlp.commands.train - _generator_B_to_A._encoder._module.bias_hh_l0
2018-10-25 21:05:11,242 - INFO - allennlp.commands.train - _generator_B_to_A._encoder._module.weight_ih_l0_reverse
2018-10-25 21:05:11,242 - INFO - allennlp.commands.train - _generator_B_to_A._encoder._module.weight_hh_l0_reverse
2018-10-25 21:05:11,242 - INFO - allennlp.commands.train - _generator_B_to_A._encoder._module.bias_ih_l0_reverse
2018-10-25 21:05:11,242 - INFO - allennlp.commands.train - _generator_B_to_A._encoder._module.bias_hh_l0_reverse
2018-10-25 21:05:11,242 - INFO - allennlp.commands.train - _generator_B_to_A._decoder_cell.weight_ih
2018-10-25 21:05:11,242 - INFO - allennlp.commands.train - _generator_B_to_A._decoder_cell.weight_hh
2018-10-25 21:05:11,243 - INFO - allennlp.commands.train - _generator_B_to_A._decoder_cell.bias_ih
2018-10-25 21:05:11,243 - INFO - allennlp.commands.train - _generator_B_to_A._decoder_cell.bias_hh
2018-10-25 21:05:11,243 - INFO - allennlp.commands.train - _generator_B_to_A._output_projection_layer.weight
2018-10-25 21:05:11,243 - INFO - allennlp.commands.train - _generator_B_to_A._output_projection_layer.bias
2018-10-25 21:05:11,243 - INFO - allennlp.commands.train - _discriminator_A._embedding.weight
2018-10-25 21:05:11,243 - INFO - allennlp.commands.train - _discriminator_A._encoder._module.weight_ih_l0
2018-10-25 21:05:11,243 - INFO - allennlp.commands.train - _discriminator_A._encoder._module.weight_hh_l0
2018-10-25 21:05:11,243 - INFO - allennlp.commands.train - _discriminator_A._encoder._module.bias_ih_l0
2018-10-25 21:05:11,243 - INFO - allennlp.commands.train - _discriminator_A._encoder._module.bias_hh_l0
2018-10-25 21:05:11,243 - INFO - allennlp.commands.train - _discriminator_A._encoder._module.weight_ih_l0_reverse
2018-10-25 21:05:11,243 - INFO - allennlp.commands.train - _discriminator_A._encoder._module.weight_hh_l0_reverse
2018-10-25 21:05:11,243 - INFO - allennlp.commands.train - _discriminator_A._encoder._module.bias_ih_l0_reverse
2018-10-25 21:05:11,243 - INFO - allennlp.commands.train - _discriminator_A._encoder._module.bias_hh_l0_reverse
2018-10-25 21:05:11,243 - INFO - allennlp.commands.train - _discriminator_A._projection_layer.weight
2018-10-25 21:05:11,244 - INFO - allennlp.commands.train - _discriminator_A._projection_layer.bias
2018-10-25 21:05:11,244 - INFO - allennlp.commands.train - _discriminator_B._embedding.weight
2018-10-25 21:05:11,244 - INFO - allennlp.commands.train - _discriminator_B._encoder._module.weight_ih_l0
2018-10-25 21:05:11,244 - INFO - allennlp.commands.train - _discriminator_B._encoder._module.weight_hh_l0
2018-10-25 21:05:11,244 - INFO - allennlp.commands.train - _discriminator_B._encoder._module.bias_ih_l0
2018-10-25 21:05:11,244 - INFO - allennlp.commands.train - _discriminator_B._encoder._module.bias_hh_l0
2018-10-25 21:05:11,244 - INFO - allennlp.commands.train - _discriminator_B._encoder._module.weight_ih_l0_reverse
2018-10-25 21:05:11,244 - INFO - allennlp.commands.train - _discriminator_B._encoder._module.weight_hh_l0_reverse
2018-10-25 21:05:11,245 - INFO - allennlp.commands.train - _discriminator_B._encoder._module.bias_ih_l0_reverse
2018-10-25 21:05:11,245 - INFO - allennlp.commands.train - _discriminator_B._encoder._module.bias_hh_l0_reverse
2018-10-25 21:05:11,245 - INFO - allennlp.commands.train - _discriminator_B._projection_layer.weight
2018-10-25 21:05:11,245 - INFO - allennlp.commands.train - _discriminator_B._projection_layer.bias
2018-10-25 21:05:11,245 - INFO - allennlp.common.params - trainer.type = default
2018-10-25 21:05:11,245 - INFO - allennlp.common.registrable - instantiating registered subclass default of <class 'allennlp.training.trainer.Trainer'>
2018-10-25 21:05:11,245 - INFO - allennlp.common.params - trainer.patience = 10
2018-10-25 21:05:11,245 - INFO - allennlp.common.params - trainer.validation_metric = -loss
2018-10-25 21:05:11,245 - INFO - allennlp.common.params - trainer.shuffle = False
2018-10-25 21:05:11,245 - INFO - allennlp.common.params - trainer.num_epochs = 2
2018-10-25 21:05:11,245 - INFO - allennlp.common.params - trainer.cuda_device = -1
2018-10-25 21:05:11,245 - INFO - allennlp.common.params - trainer.grad_norm = None
2018-10-25 21:05:11,246 - INFO - allennlp.common.params - trainer.grad_clipping = None
2018-10-25 21:05:11,246 - INFO - allennlp.common.params - trainer.learning_rate_scheduler = None
2018-10-25 21:05:11,246 - INFO - allennlp.common.params - trainer.optimizer.type = adam
2018-10-25 21:05:11,246 - INFO - allennlp.common.params - trainer.optimizer.parameter_groups = None
2018-10-25 21:05:11,246 - INFO - allennlp.training.optimizers - Number of trainable parameters: 135748
2018-10-25 21:05:11,247 - INFO - allennlp.common.registrable - instantiating registered subclass adam of <class 'allennlp.training.optimizers.Optimizer'>
2018-10-25 21:05:11,247 - INFO - allennlp.common.params - Converting Params object to dict; logging of default values will not occur when dictionary parameters are used subsequently.
2018-10-25 21:05:11,247 - INFO - allennlp.common.params - CURRENTLY DEFINED PARAMETERS: 
2018-10-25 21:05:11,247 - INFO - allennlp.common.params - trainer.optimizer.lr = 0.01
2018-10-25 21:05:11,247 - INFO - allennlp.common.params - trainer.num_serialized_models_to_keep = 20
2018-10-25 21:05:11,247 - INFO - allennlp.common.params - trainer.keep_serialized_model_every_num_seconds = None
2018-10-25 21:05:11,247 - INFO - allennlp.common.params - trainer.model_save_interval = None
2018-10-25 21:05:11,247 - INFO - allennlp.common.params - trainer.summary_interval = 100
2018-10-25 21:05:11,247 - INFO - allennlp.common.params - trainer.histogram_interval = None
2018-10-25 21:05:11,248 - INFO - allennlp.common.params - trainer.should_log_parameter_statistics = True
2018-10-25 21:05:11,248 - INFO - allennlp.common.params - trainer.should_log_learning_rate = False
2018-10-25 21:05:11,250 - INFO - allennlp.common.params - evaluate_on_test = False
2018-10-25 21:05:11,250 - INFO - allennlp.training.trainer - Beginning training.
2018-10-25 21:05:11,251 - INFO - allennlp.training.trainer - Epoch 0/1
2018-10-25 21:05:11,251 - INFO - allennlp.training.trainer - Peak CPU memory usage MB: 837.168
2018-10-25 21:05:11,273 - INFO - allennlp.training.trainer - Training
Seq2Prob(
  (_embedding): Embedding()
  (_encoder): PytorchSeq2VecWrapper(
    (_module): LSTM(30, 30, batch_first=True, bidirectional=True)
  )
  (_sigmoid): Sigmoid()
  (_projection_layer): Linear(in_features=60, out_features=1, bias=True)
)
{'ids': tensor([[ 7,  3,  3, 11,  4,  8,  0,  0,  0,  0,  0,  0],
        [ 7,  4,  2,  6,  5,  5,  2,  3,  5,  4, 10,  8],
        [ 7,  5, 10,  4,  4,  5,  9,  6,  5,  2,  9,  8]])}
